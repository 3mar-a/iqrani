{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Button,Dialog,DialogTitle,DialogContent,DialogActions,Typography,Box}from'@mui/material';import api from'../../config/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PendingBooks=()=>{const[books,setBooks]=useState([]);const[selectedBook,setSelectedBook]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState('');useEffect(()=>{fetchPendingBooks();},[]);const fetchPendingBooks=async()=>{try{const response=await api.get('/admin/pending-books');setBooks(response.data);}catch(error){setError('حدث خطأ في جلب الكتب المعلقة');}finally{setLoading(false);}};const handleApprove=async bookId=>{try{await api.put(\"/admin/approve-book/\".concat(bookId));setBooks(books.filter(book=>book._id!==bookId));}catch(error){setError('حدث خطأ في الموافقة على الكتاب');}};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062A\\u062D\\u0645\\u064A\\u0644...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{children:error});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"\\u0639\\u0646\\u0648\\u0627\\u0646 \\u0627\\u0644\\u0643\\u062A\\u0627\\u0628\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u0643\\u0627\\u062A\\u0628\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u0633\\u0639\\u0631\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u062A\\u0635\\u0646\\u064A\\u0641\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u0625\\u062C\\u0631\\u0627\\u0621\\u0627\\u062A\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:books.map(book=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:book.title}),/*#__PURE__*/_jsx(TableCell,{children:book.author.username}),/*#__PURE__*/_jsxs(TableCell,{children:[\"$\",book.price]}),/*#__PURE__*/_jsx(TableCell,{children:book.category}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(Button,{size:\"small\",onClick:()=>setSelectedBook(book),sx:{mr:1},children:\"\\u0645\\u0639\\u0627\\u064A\\u0646\\u0629\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"contained\",color:\"success\",onClick:()=>handleApprove(book._id),children:\"\\u0645\\u0648\\u0627\\u0641\\u0642\\u0629\"})]})]},book._id))})]})}),/*#__PURE__*/_jsx(Dialog,{open:!!selectedBook,onClose:()=>setSelectedBook(null),maxWidth:\"md\",fullWidth:true,children:selectedBook&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DialogTitle,{children:selectedBook.title}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,mb:2},children:[/*#__PURE__*/_jsx(\"img\",{src:selectedBook.coverImage,alt:selectedBook.title,style:{width:200,height:'auto'}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",paragraph:true,children:selectedBook.description}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",children:[\"\\u0627\\u0644\\u0633\\u0639\\u0631: $\",selectedBook.price]}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",children:[\"\\u0627\\u0644\\u062A\\u0635\\u0646\\u064A\\u0641: \",selectedBook.category]})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setSelectedBook(null),children:\"\\u0625\\u063A\\u0644\\u0627\\u0642\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",onClick:()=>{handleApprove(selectedBook._id);setSelectedBook(null);},children:\"\\u0645\\u0648\\u0627\\u0641\\u0642\\u0629\"})]})]})})]});};export default PendingBooks;","map":{"version":3,"names":["React","useState","useEffect","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Button","Dialog","DialogTitle","DialogContent","DialogActions","Typography","Box","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PendingBooks","books","setBooks","selectedBook","setSelectedBook","loading","setLoading","error","setError","fetchPendingBooks","response","get","data","handleApprove","bookId","put","concat","filter","book","_id","children","component","map","title","author","username","price","category","size","onClick","sx","mr","variant","color","open","onClose","maxWidth","fullWidth","display","gap","mb","src","coverImage","alt","style","width","height","paragraph","description"],"sources":["C:/Users/Omar/Desktop/hgfjhgblknm/frontend/src/components/Admin/PendingBooks.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Paper,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  Button,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Typography,\r\n  Box\r\n} from '@mui/material';\r\nimport api from '../../config/api';\r\n\r\nconst PendingBooks = () => {\r\n  const [books, setBooks] = useState([]);\r\n  const [selectedBook, setSelectedBook] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchPendingBooks();\r\n  }, []);\r\n\r\n  const fetchPendingBooks = async () => {\r\n    try {\r\n      const response = await api.get('/admin/pending-books');\r\n      setBooks(response.data);\r\n    } catch (error) {\r\n      setError('حدث خطأ في جلب الكتب المعلقة');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleApprove = async (bookId) => {\r\n    try {\r\n      await api.put(`/admin/approve-book/${bookId}`);\r\n      setBooks(books.filter(book => book._id !== bookId));\r\n    } catch (error) {\r\n      setError('حدث خطأ في الموافقة على الكتاب');\r\n    }\r\n  };\r\n\r\n  if (loading) return <div>جاري التحميل...</div>;\r\n  if (error) return <div>{error}</div>;\r\n\r\n  return (\r\n    <>\r\n      <TableContainer component={Paper}>\r\n        <Table>\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell>عنوان الكتاب</TableCell>\r\n              <TableCell>الكاتب</TableCell>\r\n              <TableCell>السعر</TableCell>\r\n              <TableCell>التصنيف</TableCell>\r\n              <TableCell>الإجراءات</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {books.map((book) => (\r\n              <TableRow key={book._id}>\r\n                <TableCell>{book.title}</TableCell>\r\n                <TableCell>{book.author.username}</TableCell>\r\n                <TableCell>${book.price}</TableCell>\r\n                <TableCell>{book.category}</TableCell>\r\n                <TableCell>\r\n                  <Button\r\n                    size=\"small\"\r\n                    onClick={() => setSelectedBook(book)}\r\n                    sx={{ mr: 1 }}\r\n                  >\r\n                    معاينة\r\n                  </Button>\r\n                  <Button\r\n                    size=\"small\"\r\n                    variant=\"contained\"\r\n                    color=\"success\"\r\n                    onClick={() => handleApprove(book._id)}\r\n                  >\r\n                    موافقة\r\n                  </Button>\r\n                </TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n\r\n      <Dialog\r\n        open={!!selectedBook}\r\n        onClose={() => setSelectedBook(null)}\r\n        maxWidth=\"md\"\r\n        fullWidth\r\n      >\r\n        {selectedBook && (\r\n          <>\r\n            <DialogTitle>{selectedBook.title}</DialogTitle>\r\n            <DialogContent>\r\n              <Box sx={{ display: 'flex', gap: 2, mb: 2 }}>\r\n                <img\r\n                  src={selectedBook.coverImage}\r\n                  alt={selectedBook.title}\r\n                  style={{ width: 200, height: 'auto' }}\r\n                />\r\n                <Box>\r\n                  <Typography variant=\"body1\" paragraph>\r\n                    {selectedBook.description}\r\n                  </Typography>\r\n                  <Typography variant=\"subtitle1\">\r\n                    السعر: ${selectedBook.price}\r\n                  </Typography>\r\n                  <Typography variant=\"subtitle1\">\r\n                    التصنيف: {selectedBook.category}\r\n                  </Typography>\r\n                </Box>\r\n              </Box>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={() => setSelectedBook(null)}>إغلاق</Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"success\"\r\n                onClick={() => {\r\n                  handleApprove(selectedBook._id);\r\n                  setSelectedBook(null);\r\n                }}\r\n              >\r\n                موافقة\r\n              </Button>\r\n            </DialogActions>\r\n          </>\r\n        )}\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PendingBooks; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}