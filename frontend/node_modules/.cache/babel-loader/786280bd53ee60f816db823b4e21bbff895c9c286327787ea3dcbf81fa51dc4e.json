{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Grid,Paper,Typography,Button,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Box}from'@mui/material';import{Link}from'react-router-dom';import api from'../../config/api';import AddBookForm from'./AddBookForm';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AuthorDashboard=()=>{const[books,setBooks]=useState([]);const[earnings,setEarnings]=useState(0);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[showAddForm,setShowAddForm]=useState(false);useEffect(()=>{fetchAuthorData();},[]);const fetchAuthorData=async()=>{try{const[booksResponse,earningsResponse]=await Promise.all([api.get('/books/my-books'),api.get('/author/earnings')]);setBooks(booksResponse.data);setEarnings(earningsResponse.data.totalEarnings);}catch(error){setError('حدث خطأ في جلب البيانات');}finally{setLoading(false);}};const handleDeleteBook=async bookId=>{try{await api.delete(\"/books/\".concat(bookId));setBooks(books.filter(book=>book._id!==bookId));}catch(error){setError('حدث خطأ في حذف الكتاب');}};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062A\\u062D\\u0645\\u064A\\u0644...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{children:error});return/*#__PURE__*/_jsxs(Container,{sx:{mt:4},children:[/*#__PURE__*/_jsx(Grid,{container:true,spacing:4,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Paper,{sx:{p:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,children:\"\\u0644\\u0648\\u062D\\u0629 \\u062A\\u062D\\u0643\\u0645 \\u0627\\u0644\\u0643\\u0627\\u062A\\u0628\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"\\u0627\\u0644\\u0623\\u0631\\u0628\\u0627\\u062D \\u0627\\u0644\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A\\u0629: $\",earnings]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>setShowAddForm(true),children:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u0643\\u062A\\u0627\\u0628 \\u062C\\u062F\\u064A\\u062F\"})]}),/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"\\u0639\\u0646\\u0648\\u0627\\u0646 \\u0627\\u0644\\u0643\\u062A\\u0627\\u0628\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u0633\\u0639\\u0631\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u062D\\u0627\\u0644\\u0629\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u0645\\u0628\\u064A\\u0639\\u0627\\u062A\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0627\\u0644\\u0625\\u062C\\u0631\\u0627\\u0621\\u0627\\u062A\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:books.map(book=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:book.title}),/*#__PURE__*/_jsxs(TableCell,{children:[\"$\",book.price]}),/*#__PURE__*/_jsx(TableCell,{children:book.isApproved?'تمت الموافقة':'قيد المراجعة'}),/*#__PURE__*/_jsx(TableCell,{children:book.purchases.length}),/*#__PURE__*/_jsx(TableCell,{children:!book.isApproved&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{component:Link,to:\"/author/books/edit/\".concat(book._id),size:\"small\",sx:{mr:1},children:\"\\u062A\\u0639\\u062F\\u064A\\u0644\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",color:\"error\",onClick:()=>handleDeleteBook(book._id),children:\"\\u062D\\u0630\\u0641\"})]})})]},book._id))})]})})]})})}),showAddForm&&/*#__PURE__*/_jsx(AddBookForm,{open:showAddForm,onClose:()=>setShowAddForm(false),onSuccess:()=>{setShowAddForm(false);fetchAuthorData();}})]});};export default AuthorDashboard;","map":{"version":3,"names":["React","useState","useEffect","Container","Grid","Paper","Typography","Button","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Box","Link","api","AddBookForm","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AuthorDashboard","books","setBooks","earnings","setEarnings","loading","setLoading","error","setError","showAddForm","setShowAddForm","fetchAuthorData","booksResponse","earningsResponse","Promise","all","get","data","totalEarnings","handleDeleteBook","bookId","delete","concat","filter","book","_id","children","sx","mt","container","spacing","item","xs","p","variant","gutterBottom","display","justifyContent","mb","onClick","map","title","price","isApproved","purchases","length","component","to","size","mr","color","open","onClose","onSuccess"],"sources":["C:/Users/Omar/Desktop/hgfjhgblknm/frontend/src/components/Author/AuthorDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Container,\r\n  Grid,\r\n  Paper,\r\n  Typography,\r\n  Button,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  Box\r\n} from '@mui/material';\r\nimport { Link } from 'react-router-dom';\r\nimport api from '../../config/api';\r\nimport AddBookForm from './AddBookForm';\r\n\r\nconst AuthorDashboard = () => {\r\n  const [books, setBooks] = useState([]);\r\n  const [earnings, setEarnings] = useState(0);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [showAddForm, setShowAddForm] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchAuthorData();\r\n  }, []);\r\n\r\n  const fetchAuthorData = async () => {\r\n    try {\r\n      const [booksResponse, earningsResponse] = await Promise.all([\r\n        api.get('/books/my-books'),\r\n        api.get('/author/earnings')\r\n      ]);\r\n      setBooks(booksResponse.data);\r\n      setEarnings(earningsResponse.data.totalEarnings);\r\n    } catch (error) {\r\n      setError('حدث خطأ في جلب البيانات');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteBook = async (bookId) => {\r\n    try {\r\n      await api.delete(`/books/${bookId}`);\r\n      setBooks(books.filter(book => book._id !== bookId));\r\n    } catch (error) {\r\n      setError('حدث خطأ في حذف الكتاب');\r\n    }\r\n  };\r\n\r\n  if (loading) return <div>جاري التحميل...</div>;\r\n  if (error) return <div>{error}</div>;\r\n\r\n  return (\r\n    <Container sx={{ mt: 4 }}>\r\n      <Grid container spacing={4}>\r\n        <Grid item xs={12}>\r\n          <Paper sx={{ p: 3 }}>\r\n            <Typography variant=\"h5\" gutterBottom>\r\n              لوحة تحكم الكاتب\r\n            </Typography>\r\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 3 }}>\r\n              <Typography variant=\"h6\">\r\n                الأرباح الإجمالية: ${earnings}\r\n              </Typography>\r\n              <Button\r\n                variant=\"contained\"\r\n                onClick={() => setShowAddForm(true)}\r\n              >\r\n                إضافة كتاب جديد\r\n              </Button>\r\n            </Box>\r\n            <TableContainer>\r\n              <Table>\r\n                <TableHead>\r\n                  <TableRow>\r\n                    <TableCell>عنوان الكتاب</TableCell>\r\n                    <TableCell>السعر</TableCell>\r\n                    <TableCell>الحالة</TableCell>\r\n                    <TableCell>المبيعات</TableCell>\r\n                    <TableCell>الإجراءات</TableCell>\r\n                  </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                  {books.map((book) => (\r\n                    <TableRow key={book._id}>\r\n                      <TableCell>{book.title}</TableCell>\r\n                      <TableCell>${book.price}</TableCell>\r\n                      <TableCell>\r\n                        {book.isApproved ? 'تمت الموافقة' : 'قيد المراجعة'}\r\n                      </TableCell>\r\n                      <TableCell>{book.purchases.length}</TableCell>\r\n                      <TableCell>\r\n                        {!book.isApproved && (\r\n                          <>\r\n                            <Button\r\n                              component={Link}\r\n                              to={`/author/books/edit/${book._id}`}\r\n                              size=\"small\"\r\n                              sx={{ mr: 1 }}\r\n                            >\r\n                              تعديل\r\n                            </Button>\r\n                            <Button\r\n                              size=\"small\"\r\n                              color=\"error\"\r\n                              onClick={() => handleDeleteBook(book._id)}\r\n                            >\r\n                              حذف\r\n                            </Button>\r\n                          </>\r\n                        )}\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </TableContainer>\r\n          </Paper>\r\n        </Grid>\r\n      </Grid>\r\n\r\n      {showAddForm && (\r\n        <AddBookForm\r\n          open={showAddForm}\r\n          onClose={() => setShowAddForm(false)}\r\n          onSuccess={() => {\r\n            setShowAddForm(false);\r\n            fetchAuthorData();\r\n          }}\r\n        />\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default AuthorDashboard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}